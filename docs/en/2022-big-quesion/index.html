<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ilya Kashnitsky">
<meta name="dcterms.date" content="2022-04-07">
<meta name="description" content="Jim was an enthusiastic explorer not bounded by the arbitrary limits of any discipline. And he thought that his beloved demography encompassed perfectly all his diverse research interests.">

<title>What is your BIG question? – words</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//img/logo.webp" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta property="og:title" content="What is your BIG question?">
<meta property="og:description" content="Dr.&nbsp;Ilya Kashnitsky’s various texts (in English and Russian) scattered across the internet.">
<meta property="og:image" content="https://writings.ikashnitsky.phd/en/2022-big-quesion/jwv.jpg">
<meta property="og:site_name" content="words">
<meta property="og:locale" content="en_US">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">words</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://ikashnitsky.phd"> 
<span class="menu-text">ikashnitsky.phd</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ikashnitsky"> <i class="bi bi-github" role="img" aria-label="github">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/ikashnitsky"> <i class="bi bi-linkedin" role="img" aria-label="linkedin">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/@ikashnitsky"> <i class="bi bi-mastodon" role="img" aria-label="mastodon">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://bsky.app/profile/ikashnitsky.phd"> <i class="bi bi-check-circle-fill" role="img" aria-label="bluesky">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:ilya.kashnitsky@gmail.com"> <i class="bi bi-envelope-fill" role="img" aria-label="email">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss-fill" role="img" aria-label="rss">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">What is your BIG question?</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 7, 2022</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<script src="https://cdn.counter.dev/script.js" data-id="daa70324-89c3-4b1c-8ea0-3588f29f41f5" data-utcoffset="1"></script><p>I first saw Jim in June 2014 in Budapest, at the European Population Conference. I had just finished my master’s and was about to start a Ph.D.&nbsp;in the Netherlands. The world of European demography felt novel, unexplored and shining. There I met some EDSD students from a fresh cohort and with a touch of jealousy I realised that I was apparently missing such a unique opportunity. Then we were walking in the afternoon sunlit Budapest, and suddenly they started whispering «Look! Jim Vaupel!». Jim was walking surrounded by a tight pack of people, talking animatedly and laughing contagiously. There was such a powerful «live legend» aura around him. That was it for several years. Only the excited whisper «Jim Vaupel» cut deep in my memory. I even asked back then «Who is Jim Vaupel?». And the answer was something like «he founded everything, including EDSD».</p>
<p>The next time I interacted indirectly with Jim was in October 2016. A horrible paper arguing the existence of a limit to human lifespan came out in Nature and immediately made a lot of noise. An editor of the science section of Meduza (a prominent independent media source in Russia) asked me to comment on this paper, a legit newsmaker of the first days. And here I was, a second-year Ph.D.&nbsp;student reading a paper from Nature and concluding that it was pure bullshit. The editor was slightly puzzled. Luckily on the next day, I brought him a link where Jim Vaupel himself called this paper a «travesty». Eventually, 5 outraged letter responses were published in Nature, mine was rejected on the basis that the journal had received too many submissions for this particular paper. I was yet to learn how to collaborate on the ideas.</p>
<p>Finally, at the beginning of our EDSD cohort in September 2017 we had a welcome meeting scheduled to meet Jim Vaupel—somehow, I managed to miss that one too. At the same exact time as the meeting I had to deliver a presentation at the Statistics Week Conference that happened to be in Rostock that year. So instead I had an email introduction apologising for having to miss the meeting. Jim replied immediately saying that conferences are important and we would have time to talk in Odense.</p>
<p>Finally, after years of missing the chance to speak to him, I met Jim in Odense in November 2017, where Jim was teaching us about the regularities of human mortality. Jim’s teaching style was pretty unique: most of the time he just opened his own published papers and scrolled through them, commenting. Doesn’t sound too fascinating, right? Wrong. It was enlightening and inspiring. Rarely as a student do you know clearly that you are lucky to be here. Jim’s assignment was very creative: come up with our own model to explore some demographic processes. As he told us instructing on the assignment: «Model simple, think complex!», one of the many wonderful sayings he imparted on us through the years, like «Do not read too much. Think!» or «You should spend one third of your time working on a paper choosing a good title and composing a great opening phrase!» or «You should re-write your paper 17 times; only then it’s done». Perhaps, the most memorable was when he was telling us what science knows about the ways to prolong own lifespan: «Do what your mom told you: clean teeth, go to bed in time, eat healthily, wear a warm woolen hat when it’s cold, do sports, don’t smoke, don’t drink much alcohol». There was something puzzling and exciting about one of the leading mortality researchers telling you that we don’t know much more than the common sense hard learned basics. And this honesty marked a true explorer not afraid to say «I don’t know», «we don’t know yet». He was in an honest search for answers to the questions that burned his curiosity. The main message of his teaching was «What is your BIG question? Do find the biggest question that fires you up and spend your honest efforts trying to answer it. Don’t spend your life on small questions».</p>
<p>Towards the end of our EDSD in Odense Jim ordered a big batch of books ‘Essential Demographic Methods’ by his friend Kenneth Wachter. He presented each of us with a signed copy of this beautiful book.</p>
<p><img src="bigq-1.png" class="img-fluid" style="width:60.0%"></p>
<p>In early spring 2018, I brought the innovative ternary dataviz that we developed with Jonas to Jim.</p>
<blockquote class="blockquote">
<p>– Oh, great. This is curious. Where do you want to submit it?<br>
– Science.<br>
– Oh boy! Ilya, I don’t want to discourage you—and this map <em>is</em> exciting—but I think that you have zero chances in Science.<br>
– Hmm. I think so too. I will still try.<br>
– Okay. Then, you should write your first paragraph in a way that…</p>
</blockquote>
<p>And then Jim spent 15 minutes explaining to me how you write papers for the big journals. I submitted it to Science and was desk rejected in two days. Then I submitted it to Nature and it was desk rejected in one day. Then I submitted it to Lancet. And after a frustrating month, it was accepted. I came to Jim with the burning news.</p>
<blockquote class="blockquote">
<p>– Jim, the letter is accepted in Lancet.<br>
– Wow! Good for you!</p>
</blockquote>
<p>The same day Jim asked me to come to his office, a beautiful spacious room in the always sunlit corner of the building.</p>
<blockquote class="blockquote">
<p>– Congratulations on your Lancet publication. I award you a place of a research assistant in my group.</p>
</blockquote>
<p>And that was typical Jim. He considered working with him as a privilege, and so it was.</p>
<p><img src="bigq-2.png" class="img-fluid" style="width:80.0%"></p>
<p>I started working with Jim in September 2018. It was very uneven, sometimes very intense, other times more relaxed. If Jim got a new idea he was obsessed with it. His flying scientific imagination coexisted with exceptional attention to details. Jim loved delivering his ideas efficiently and he valued dataviz a lot. I have a passion for dataviz. There were months in which I would produce dozens of versions of various plots reflecting the flow and evolution of Jim’s ideas. At times that was borderline frustrating. But there was one constant laying feature of this process: Jim always listened to you in the discussions and honestly strived for the best possible outcome. His drive and energy and the constant feeling that we are moving to something even better were dope. And if I strongly disagreed on something and it made sense, Jim listened and was able to correct his view, no snobbism or condescending involved.</p>
<p>Jim was always proud of us, the young ones privileged to work with him. He used to say «I have the best demographers in the world» presenting his team anywhere. This was too American. Jim didn’t care. He was unapologetically himself. And with him around and his eternal confidence we got used to hearing his usual «top of the world» mantra but also learned to set the highest goals and pursue sometimes wild ambitions. Only big questions, only big goals.</p>
<p>In my first months with Jim we did a crazy detour from demography to bibliometrics. Jim was fascinated to learn that the famous demographer Alfred Lotka wrote a seminal paper in bibliometrics in 1926. Jim immediately called that we should explore bibliodemography—the study of the births, lives, and deaths of publications.</p>
<p><img src="bigq-3.png" class="img-fluid" style="width:60.0%"></p>
<p>Our work on this detour culminated with a strange meeting with the rector to discuss some aspects of research evaluation based on publications and citations. We got a time slot at 7:45 in the morning. The day before I was still finishing slides. Jim was very nervous that I wouldn’t finish in time. When I finally showed him the slides late in the afternoon he said with a smirk «You can’t lecture the rector». In the end, we decided that we would go with the printouts of my text and dataviz report. And it was a good decision. Though Jim was still visibly nervous and uneasy.</p>
<blockquote class="blockquote">
<p>– Jim, do I need to know something special about the rector or the meeting?<br>
– No, nothing special. Just strange that you are so calm.</p>
</blockquote>
<p>Only later I guessed that this meeting was aimed to explain the unique interdisciplinary nature of our research group and the position Jim envisioned for our centre in between all the faculties. The meeting went smoothly but the big idea of CPop as a truly interdisciplinary centre uniting the faculties was destined to sink into the bureaucracy at the university. Jim hated losing time in unconstructive management meetings. In the end, he stepped down from the director of the centre position to finally focus on research and immediately won an ERC Advanced Grant. And then the pandemic came.</p>
<p>The remote setting really didn’t fit Jim’s impulsive nature. For once–he probably felt–demography and the analysis of human mortality in particular was in the centre of everyone’s attention. And we were in between other important projects and ideas, not perfectly ready to refocus and immediately deliver. We did it but mostly in summer of 2020 when it became possible to meet in person—Jim was revived in face-to-face talks.</p>
<p>Jim was on my Ph.D.&nbsp;committee in October 2020. It was a Dutch-style defense when the candidate only answers questions for 45 minutes. The goal of the candidate is not to go on the second round of questions, which are traditionally harder and more specific. Jim’s question was the last among the six. Somehow, I had failed to guess his usual question and had to ad lib, even though he asked his single most important question—what was the BIG question in my research project? Even now I recall how nervous I was then, and how I didn’t manage to speak smoothly. It was a huge relief to learn some days later that Jim was properly satisfied.</p>
<p>The last thing I worked on closely with Jim was a book chapter on Danish longevity prospects which he asked Marie-Pier and me to help him with, in September-October 2021. Of course, the book chapter appeared out of the blue and had to be finished «this Friday». Of course, it was done in several weeks. Of course it came on top of everything. Finally it was done by the end of October. Then I was away for months, recovering from sudden health issues. Then I started returning back, and now Jim was away, eagerly awaited to return with his usual excitement and new ideas. And then suddenly he was gone.</p>
<p>The book containing our chapter arrived the following week. I never thought that this was to become my last reminder of working with Jim.</p>
<p><img src="bigq-4.png" class="img-fluid" style="width:80.0%"></p>
<p>Jim was an exceptional teacher and colleague, always a bit more than just your boss or senior coauthor. Always understanding but crashing the schedules and others’ perception of what’s possible with his enthusiasm. Always knowing exactly where he was heading and how he wanted to get there but listening carefully to what others had to say, especially if that was a carefully thought-through contradicting point. Jim was big. A living legend of demography, he could have just relaxed a bit. But that’s not how he lived. He always thought that the idea that occupied his mind right now was the next BIG idea, even more significant than the previous ones.</p>
<p>I’m trying to think what’s my most vivid memory of Jim. And I think I know: sunlit spacious room with plants and photos of beloved grand-kids, Jim is sitting at the small round guest table facing the door and the corridor, only a sheet of paper in front of him and a pen in his hand.</p>
<blockquote class="blockquote">
<p>– Jim, can I discuss an idea with you?<br>
– Of course, my friend. Come in. I was doing some maths here. You know, maths makes me happy.</p>
</blockquote>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Original publication: <a href="https://remembering-james-vaupel.org/post/ilya-kashnitsky/">Remembering James Vaupel</a> | <a href="https://archive.md/ojWrW">Archived vesrion</a>
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/writings\.ikashnitsky\.phd");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block"><i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> 2017–2025 Ilya Kashnitsky</span> <span class="faux-block"><a href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> <i class="fa-brands fa-creative-commons-by" aria-label="creative-commons-by"></i> <i class="fa-brands fa-creative-commons-sa" aria-label="creative-commons-sa"></i> Creative Commons CC BY-SA 4.0</a></span></p>
</div>   
    <div class="nav-footer-center">
<p><span class="faux-block"><i class="fa-brands fa-orcid" aria-label="orcid"></i> <strong>ORCID</strong> <a href="https://orcid.org/0000-0003-1835-8687">0000-0003-1835-8687</a></span> <span class="faux-block"><a rel="me" href="https://bsky.app/profile/ikashnitsky.phd"><strong>BlueSky</strong></a> <a rel="me" href="https://fosstodon.org/@ikashnitsky"> <i class="fa-brands fa-mastodon" aria-label="mastodon"></i> <strong>Mastodon</strong></a></span></p>
</div>
    <div class="nav-footer-right">
<p><span class="faux-block">Made with <i class="fa-brands fa-r-project" aria-label="r-project"></i> and <a href="https://quarto.org/">Quarto</a></span> <span class="faux-block"><a href="https://github.com/ikashnitsky/ikashnitsky.github.io">View the source at <i class="fa-brands fa-github" aria-label="github"></i> GitHub</a></span></p>
</div>
  </div>
</footer>




</body></html>